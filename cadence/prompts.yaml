# Claude Cadence Prompt Configuration
# This file defines all prompts used in the task-driven supervision system

# Shared context that appears in all agent prompts
shared_agent_context:
  supervision_explanation: |
    === TASK EXECUTION CONTEXT ===
    You are working under a task-driven supervision system.
    Primary goal: Complete your assigned TODOs efficiently
    Safety limit: Maximum {max_turns} turns (not a target)
    
    IMPORTANT: Focus on completing tasks, not counting turns. The turn limit is only a safety measure.
  
  work_guidelines: |
    IMPORTANT - TASK-DRIVEN EXECUTION:
    
    You have up to {max_turns} turns as a safety limit, but this is NOT a target.
    Your ONLY goal is to complete the assigned TODOs. Work naturally and efficiently.
    
    CRITICAL: The moment ALL TODOs are complete, you MUST:
    1. Declare "ALL TASKS COMPLETE"
    2. Exit immediately - do not continue working
    
    The turn limit exists only to prevent infinite loops. Most tasks should complete
    well before reaching it.
    
    Progress tracking:
    - Mark completed tasks: {"task_complete": {"task_id": "1", "task_title": "Create file X"}}
    - Note any blockers for supervisor review
    - Quality completion matters more than speed
  
  early_exit_protocol: |
    EARLY EXIT PROTOCOL:
    - If you complete all assigned tasks before using all turns, state 'ALL TASKS COMPLETE' and exit
    - Do not continue working beyond what was requested
    - Do not wait for confirmation after completing tasks

# Initial agent prompt template
agent_prompts:
  initial:
    sections:
      - "{shared_agent_context.supervision_explanation}"
      - "{shared_agent_context.work_guidelines}"
      - "{shared_agent_context.early_exit_protocol}"
      - "{todo_list}"  # Generated dynamically
      - |
        === YOUR OBJECTIVE ===
        Complete all the TODOs listed above.
        
        Remember: Complete your tasks thoroughly. The turn limit ({max_turns}) is just a safety net.
        Begin working on the TODOs now.
  
  # Continuation prompt for resumed execution
  continuation:
    sections:
      - |
        === TASK CONTINUATION ===
        You are continuing work on TODOs.
        Safety limit: {max_turns} turns remaining
      - "{continuation_context}"  # Previous execution context
      - "{progress_summary}"  # Generated dynamically
      - "{remaining_todos}"    # Generated dynamically
      - "{issues_section}"    # Generated dynamically if issues exist
      - |
        === SUPERVISOR GUIDANCE ===
        {supervisor_guidance}
      - "{shared_agent_context.work_guidelines}"
      - |
        Continue working to complete all remaining TODOs.
        Remember: When all TODOs are done, state 'ALL TASKS COMPLETE' and exit immediately.

# TODO-specific templates
todo_templates:
  todo_list: |
    === YOUR TODOS ===
    The following TODOs need to be completed:
    
    {todo_items}
    
    Focus on completing these systematically. 
    When all are done, state 'ALL TASKS COMPLETE' and exit immediately.
  
  todo_item: "{number}. {todo_text}"
  
  progress_summary: |
    === COMPLETED WORK ===
    The following has been accomplished:
    {completed_items}
  
  remaining_work: |
    === REMAINING WORK ===
    Still need to complete:
    {remaining_items}
  
  issues_section: |
    === ISSUES TO ADDRESS ===
    {issue_list}

# Execution-specific warnings
execution_warnings:
  final_turns: |
    ⚠️  APPROACHING TURN LIMIT!
    You are near the {max_turns} turn safety limit.
    Focus on completing the most critical remaining work.

# Supervisor analysis prompts
supervisor_prompts:
  analysis:
    sections:
      - |
        === SUPERVISOR ANALYSIS TASK ===
        You are a senior software architect reviewing task progress.
        Analyze the work done and provide strategic guidance.
        
        Turns used: {turns_used} of {max_turns}
      - |
        === ORIGINAL OBJECTIVE ===
        {original_task}
      - "{task_progress}"  # Generated if tasks exist
      - "{execution_history}"  # Generated from previous executions
      - |
        === EXECUTION OUTPUT TO ANALYZE ===
        {execution_output}
      - |
        === ANALYSIS REQUIRED ===
        Provide a strategic analysis covering:
        1. Is the agent making appropriate progress toward the objective?
        2. Are there any critical issues or blockers?
        3. What specific guidance would help complete remaining TODOs?
        4. Should the agent adjust priorities or approach?
        
        Be specific and actionable in your guidance.
        Focus on architectural decisions and avoiding common pitfalls.
        
        Format your response as clear, bullet-pointed guidance.
  
  task_progress_template: |
    === TASK PROGRESS ===
    Completed: {completed_count} tasks
    Remaining: {remaining_count} tasks
  
  execution_history_template: |
    === EXECUTION HISTORY ===
    {history_items}
  
  history_item: "Execution {num}: {summary}"

# Final summary template
final_summary:
  template: |
    === SUPERVISION SESSION COMPLETE ===
    Total executions: {executions_count}
    Total turns used: {total_turns}
    Estimated duration: ~{duration_minutes} minutes
    
    {completed_section}
    {incomplete_section}
    
    === EXECUTION PROGRESSION ===
    {execution_progression}
    
    {recommendations}
  
  completed_section: |
    === COMPLETED TASKS ===
    {completed_list}
  
  incomplete_section: |
    === INCOMPLETE TASKS ===
    {incomplete_list}
  
  recommendations: |
    === RECOMMENDATIONS ===
    Consider running another supervision session to complete remaining tasks.
    Alternatively, continue manually with the following focus:
    {focus_items}